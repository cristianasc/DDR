Matrizes;
miu= R*1e9/(8*1000);
NumberLinks= sum(sum(R>0));
gama= sum(sum(T(:,3:4)));
d= L*1e3/2e8;

pairs = [];

% fill the connected pairs
for origin=1:19
    if T(origin,destination)>0
        pairs = [pairs; origin destination]
    end
end

npairs = size(pairs,1);
lambda= zeros(20);
routes= zeros(npairs,20);
for i=1:npairs
    origin= pairs(i,1);
    destination= pairs(i,2);
    lambda_od= pairs(i,3);
    lambda_do= pairs(i,4);
    r= ShortestPathSym(d,origin,destination); 
    routes(i,:)= r;
    j= 1;
    while r(j)~= destination
        lambda(r(j),r(j+1))= lambda(r(j),r(j+1)) + lambda_od; 
        lambda(r(j+1),r(j))= lambda(r(j+1),r(j)) + lambda_do; 
        j= j+1;
    end
end
Load= lambda./miu;
Load(isnan(Load))= 0;
MaximumLoad = max(max(Load))
AverageLoad = sum(sum(Load))/NumberLinks